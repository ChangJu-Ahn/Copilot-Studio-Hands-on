# Module#1 – Agent 생성 및 기본 설정

Copilot studio에서는 Low Code 형식으로 Custom Engine Agent를 생성할 수 있습니다.

Copilot studio는 일반 사이트와 Preview 사이트 2곳으로 나뉘며, 이번 실습은 현재 Preview 기능 중 하나인 M365 Copilot app에 Agent를 배포하는 것까지 포함이 되어 있기에, preview 사이트에서 실습을 진행합니다.

- **Copilot Studio Preview**: https://copilotstudio.preview.microsoft.com  
- **Copilot Studio**: https://copilotstudio.microsoft.com

---

사이트로 이동하여 로그인을 하게 되면, 우측 상단에 환경이 표시됩니다.    
Power platform 관리자의 설정에 따라 Default 환경으로 이동하거나, 또는 사용자 개인 개발 환경이 자동 생성 및 할당이 될 수도 있습니다.

</br>

환경 이동이 완료되었으면, 에이전트를 생성하기 위해 우측 패널의 **[에이전트]** 또는 **[만들기]** 를 선택한 후 **[+ 새 에이전트]** 로 이동합니다.
<img width="1090" height="167" alt="image" src="https://github.com/user-attachments/assets/f3b3129b-bfa9-42bd-839a-752aa13b1a29" />

</br>

새 에이전트 생성을 선택하면 에이전트 구축 시작 페이지가 나오며, 이곳에서 에이전트의 기본 설정등을 구성할 수 있습니다.

가장 먼저 해야 할 것은 에이전트의 **언어 업데이트**입니다. 우측 상단의 **[…]** 을 선택하면 **[에이전트 언어 업데이트]** 옵션이 있습니다. 기본적으로 한국어로 지정되어 있지만, 영어로 되어 있을 경우, 한국어로 변경합니다.  
(현재 한국어기반의 생성형 AI는 Preview 기능이며 일부 기능들은 정상 동작을 하지 않습니다. 지침을 영어 베이스로 구성 할 경우 언어설정을 영어로 하여도 됩니다.)
<img width="800" height="300" alt="image" src="https://github.com/user-attachments/assets/6a769ce2-8ae7-4b5f-9377-94d74946aecf" />

</br>

---

이후 **[구성]** 을 선택하여 에이전트의 이름과 지침을 다음과 같이 입력합니다.

- **이름**: `[유저명]_온보딩_에이전트` 예) `msk001_온보딩 에이전트`  
- **설명**: 자유롭게 입력  
- **지침**:

```markdown
당신은 임직원들의 질의사항에 답변을 하는 Agent입니다. 아래 규칙에 맞추어 응대를 합니다.

규칙  
1. 질문이 들어올 경우, 먼저 해당 질문이 어떤 주제와 관련이 있는지 파악한 후 [질의응답 플로우 – admin] 도구를 실행 합니다.  
[질의응답 플로우 – admin] 에 들어가는 카테고리는 IT,복지,급여,조직 4가지중 하나만 입력합니다.  

카테고리: 카테고리 설명  
- IT : IT설정, 서비스, 기능과 관련된 문의사항에 대한 주제 입니다.  
- 복지 : 회사 복지 정책에 관한 문의사항에 대한 주제 입니다.  
- 급여 : 급여, 계약, 상여금에 관한 문의사항에 대한 주제 입니다.  
- 조직 : 조직 문화, 사내 행사, 이벤트 등에 관한 주제 입니다.  

2. [질의응답 플로우 – admin] 의 답변이 "NO"로 올 경우, 아래 '담당자 리스트'에서 메일주소를 파악하여, "질문자", "질문 시각", "질문 내용"을 포함하여 [메일 보내기(V2)] 를 이용하여 메일을 전송합니다. 메일은 '메일 작성 규칙'에 의거하여 작성합니다.  

답변 지침  
답변에는 반드시 참조 자료 링크를 제공하지 않습니다.  

메일 작성 규칙  
1. 제목(Subject)은 [주제] + '질문 요약' 의 형태를 준수합니다.  
2. 주제는 다음 4개의 선택지 중 가장 적절한 항목을 선택하여 작성합니다.  
   - [IT 환경 설정 문의]  
   - [계약 급여 및 4대보험 관련 문의]  
   - [복지 및 휴가 관련 문의]  
   - [조직 및 문화 관련 문의]  
3. 본문(body)는 "질문자", "질문 시각", "질문 내용" 을 넣도록 하며, 가시성을 위해 HTML 형식으로 변환하여 입력합니다.  
4. 질문 시각은 UTC+9으로 변환하여 입력합니다.  

담당자 리스트  
- IT_환경_설정: admin@M365CPI45255191.onmicrosoft.com  
- 계약_급여_4대보험: chiwonchoi@microsoft.com  
- 복지_및_휴가: hangu4043@chiwon.xyz  
- 조직_및_문화: changjuahn@chiwon.xyz
```

**중요. 1**
주황색으로 표기된 기능은 지침 내 특정 토픽, 도구 등을 실행시키는 선언문입니다. 현재는 도구 및 토픽이 생성되어 있지 않기 때문에 이를 호출할 수 없으며, **Module을 모두 마치고 추가**합니다.   

**중요. 2**
Agent는 토픽 내에 플로우가 지정되어 작업을 시행하는 것이 아니라면, 해당 지침에 따라 업무를 수행하기 때문에 매우 중요합니다.
따라서 지침은 가급적 **마크다운 형식과 역할, 순서 로직에 맞추어 상세하게 작성**합니다.   

참조자료, 시작 프롬프트와 같은 추가 설정은 지금 작성하여도 되지만, 이후에도 추가할 수 있으니 지금 단계에서는 별로 작업을 하지 않고 상단의 [계속] 버튼을 클릭합니다.
<img width="1090" height="1186" alt="image" src="https://github.com/user-attachments/assets/05c43057-c62e-4260-9c53-975f232a0a24" />


최초 저장이 완료되면 아래와 같이 추가적인 설정을 할 수 있으며, 다음과 같이 설정을 변경합니다.   
```
오케스트레이션: 활성화   
AI에서 자체 일발 참조자료를 사용 / 웹 검색(옵션): 비활성화
```

- [오케스트레이션] 이 비활성화 되어 있을 경우, Agent는 생성형 AI기반으로 동작하지 않기에 앞서 작성한 [지침]에 영향을 받지 않고, 과거 클래식 챗봇처럼 토픽을 통해 라우팅 처리 작업을 모두 만들어 주어야만 동작을 하는 에이전트가 됩니다.
- [AI에서 자체 일발 참조자료를 사용] 및 [웹 검색] 옵션의 경우, 목적에 따라 활성화, 비활성화합니다.
- 실습 에이전트는 주어진 정보와 내용을 바탕으로만 답변을 주어야 하기 때문에, 웹검색과 사전 학습 지식에 대한 답변 활용을 **비활성화** 합니다.
<img width="1078" height="1172" alt="image" src="https://github.com/user-attachments/assets/a61bfc7f-f071-4775-bc73-f140cfc90421" />


</br>
</br>

이후 **[토픽]** 으로 이동하여, 기본적으로 생성되어 있는 **[사용자 지정 토픽] 전체와 [시스템 토픽 – 대체, 일치하는 여러 토픽]을 비활성화** 합니다.
<img width="1090" height="493" alt="image" src="https://github.com/user-attachments/assets/32bce081-c1ff-4f0d-8c5c-a37f0c4ffc42" />   

</br>

**중요!**
이 작업은 Agent의 오케스트레이션이 생성형 AI로 변경되고, 이후 신규 토픽이 추가될 경우(다음 모듈) 지침과 함께 토픽에 설정된 AI 트리거 설명을 함께 검토하게 됩니다.   

</br>

기본적으로 생성된 지침의 경우 별도 설명이 포함되어 있지 않기 때문에 토픽이 중복되어 정상 답변을 할 수 없는 문제가 발생되기도 하므로, 오케스트레이션을 활성화한 상태에서 토픽을 수정, 생성하여 Agent를 운용할 예정이라면 반드시 기본 토픽은 모두 비활성화하고 신규 토픽에 대해서는 트리거에 따라 설명을 자세하게 기입합니다.

---

