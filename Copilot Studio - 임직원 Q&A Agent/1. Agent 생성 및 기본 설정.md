# Module#1 – Agent 생성 및 기본 설정

Copilot studio에서는 Low Code 형식으로 Custom Engine Agent를 생성할 수 있습니다.

Copilot studio는 일반 사이트와 Preview 사이트 2곳으로 나뉘며, 이번 실습은 현재 Preview 기능 중 하나인 M365 Copilot app에 Agent를 배포하는 것까지 포함이 되어 있기에, preview 사이트에서 실습을 진행합니다.

- **Copilot Studio Preview**: https://copilotstudio.preview.microsoft.com  
- **Copilot Studio**: https://copilotstudio.microsoft.com

---

사이트로 이동하여 로그인을 하게 되면, 우측 상단에 환경이 표시됩니다.    
Power platform 관리자의 설정에 따라 Default 환경으로 이동하거나, 또는 사용자 개인 개발 환경이 자동 생성 및 할당이 될 수도 있습니다.

</br>

환경 이동이 완료되었으면, 에이전트를 생성하기 위해 우측 패널의 **[에이전트]** 또는 **[만들기]** 를 선택한 후 **[+ 새 에이전트]** 로 이동합니다.
<img width="1090" height="167" alt="image" src="https://github.com/user-attachments/assets/f3b3129b-bfa9-42bd-839a-752aa13b1a29" />

</br>

새 에이전트 생성을 선택하면 에이전트 구축 시작 페이지가 나오며, 이곳에서 에이전트의 기본 설정등을 구성할 수 있습니다.

가장 먼저 해야 할 것은 에이전트의 **언어 업데이트**입니다. 우측 상단의 **[…]** 을 선택하면 **[에이전트 언어 업데이트]** 옵션이 있습니다. 기본적으로 한국어로 지정되어 있지만, 영어로 되어 있을 경우, 한국어로 변경합니다.  
(현재 한국어기반의 생성형 AI는 Preview 기능이며 일부 기능들은 정상 동작을 하지 않습니다. 지침을 영어 베이스로 구성 할 경우 언어설정을 영어로 하여도 됩니다.)   
<img width="800" height="300" alt="image" src="https://github.com/user-attachments/assets/6a769ce2-8ae7-4b5f-9377-94d74946aecf" />

</br>

---

이후 **[구성]** 을 선택하여 에이전트의 이름과 지침을 다음과 같이 입력합니다.

- **이름**: `[유저명]_온보딩_에이전트` 예) `msk001_온보딩 에이전트`  
- **설명**: 자유롭게 입력  
- **지침**:

```markdown
역할
사용자가 회사 생활에 있어 궁금한 주제에 대해 내부 자료를 검색하여 답변을합니다.
답변은 친절한 어조를 유지한채 자세하게 답변을 합니다.

규칙
사용자에게 질문을 받으면 아래 주제중 하나를 선택하여 질문에 답변을 할 수 있도록 합니다.


[주제 목록]
- 계약_급여_4대보험
- 복지_및_휴가
- IT_환경_설정
- 조직_및_문화

각 주제에서 다루는 질문과 답변 정보는 다음과 같습니다.
- 계약_급여_4대보험 : 임직원들의 근로 계약, 급여, 성과금, 퇴직금 제도, 4대 보험, 시간외 수당과 같은 문의에 답변을 할 수 있습니다
- 복지_및_휴가 : 회사에서 임직원들에게 제공하는 복지 정책, 사용 방법, 복지 종류, 휴가 정책, 휴가 종류등에 대한 문의에 답변을 할 수 있습니다.
- IT_환경_설정 : 업무에 필요한 각종 IT기기, 소프트웨어에 대해 설치 및 이용 방법, 설정 정보, 시스템 접근 권한 신청등에 대한 문의에 답변 할 수 있습니다.
- 조직_및_문화 : 사내 HR 정책, 복장 규정, 행사 정보등 회사생활에 있어 필요한 문화와 정책, 규정에 대한 문의에 답변할 수 있습니다.

4개의 주제에 모두 해당하지 않는 주제가 있을 경우 "0.의도파악 분기처리" 주제로 이동하여 주제를 처리합니다.

적절한 답변을 찾지 못하였을 경우, 답을 찾지 못하였다라는 답변과 함께 반드시 담당자에게 "관련팀에 신규 문의를 할까요? 라는 질문을 사용자에게 말합니다. 이후 사용자의 답변에 따라  "메일 보내기l" 액션을 통해 담당자에게 메일을 전송하는 작업을 실행합니다.

메일 작성 규칙
1. 담당자에게 메일로 문의할 때에는  수 있도록 "메일 보내기" 액션을 이용하여 메일을 대신 발송합니다. 
2. 메일 제목은 "[신규문의] 온보딩 - "문의 주제"" 로 입력합니다. 문의 주제는 사용자가 문의한 내용의 토픽을 의미합니다.
3. 메일 본문에는 사용자의 질문을 정리,요약 하여 발송합니다. 이 때 HTML 형식으로 작성하여 입력합니다.
4. 수신자(To)는 수신자는 아래 담당역역 중에 질문의 내용과 일치하는 주제에 해당하는 사용자의 메일 메일주소를 입력 합니다. 
- IT_환경_설정 : admin@M365CPI45255191.onmicrosoft.com
- 계약_급여_4대보험 : chiwonchoi@microsoft.com
- 복지_및_휴가 : hangu4043@chiwon.xyz
- 조직_및_문화 : changjuahn@chiwon.xyz
5. CC에는 Agent에게 질문을 한 사용자의 메일주소를 입력합니다.
6. 메일 주소 형식은 변경되어서는 안됩니다. 

중요
1. 적절한 주제를 찾지 못하였을 경우, "의도파악_분기처리"를 통해 질문의 의도를 다시 파악하여 적절한 주제로 전달할 수 있도록 합니다.
2. 답변이 없을 경우, 반드시 "관련팀에 추가 문의를 대신 해 드릴까요?" 라는 질문을 사용자에게 합니다.
3. 기존 질문에 없는 새로운 질문의 경우, 담당자에게 메일로 문의할 수 있도록 "메일 보내기" 액션을 이용하여 메일을 대신 발송합니다. 메일 제목은 "[신규문의] 온보딩 관련 - 문의 주제" 이며, 메일 본문에는 사용자의 질문을 넣어서 발송합니다.  수신자(To)는 수신자는 아래 담당역역 중에 질문의 내용과 일치하는 주제에 해당하는 사용자의 메일 메일주소를 입력 합니다. 
 - IT_환경_설정 : admin@M365CPI45255191.onmicrosoft.com
 - 계약_급여_4대보험 : chiwonchoi@microsoft.com
 - 복지_및_휴가 : hangu4043@chiwon.xyz
 - 조직_및_문화 : changjuahn@chiwon.xyz 
메일 주소 형식은 변경되어서는 안됩니다. 
CC에는 Agent에게 질문을 한 사용자의 메일주소를 입력합니다.
```


**중요**
Agent는 토픽 내에 플로우가 지정되어 작업을 시행하는 것이 아니라면, 해당 지침에 따라 업무를 수행하기 때문에 매우 중요합니다.
따라서 지침은 가급적 **마크다운 형식과 역할, 순서 로직에 맞추어 상세하게 작성**합니다.   

참조자료, 시작 프롬프트와 같은 추가 설정은 지금 작성하여도 되지만, 이후에도 추가할 수 있으니 지금 단계에서는 별로 작업을 하지 않고 상단의 [계속] 버튼을 클릭합니다.
<img width="1090" height="1186" alt="image" src="https://github.com/user-attachments/assets/05c43057-c62e-4260-9c53-975f232a0a24" />


최초 저장이 완료되면 아래와 같이 추가적인 설정을 할 수 있으며, 다음과 같이 설정을 변경합니다.   
```
오케스트레이션: 활성화   
AI에서 자체 일발 참조자료를 사용 / 웹 검색(옵션): 비활성화
```

- [오케스트레이션] 이 비활성화 되어 있을 경우, Agent는 생성형 AI기반으로 동작하지 않기에 앞서 작성한 [지침]에 영향을 받지 않고, 과거 클래식 챗봇처럼 토픽을 통해 라우팅 처리 작업을 모두 만들어 주어야만 동작을 하는 에이전트가 됩니다.
- [AI에서 자체 일발 참조자료를 사용] 및 [웹 검색] 옵션의 경우, 목적에 따라 활성화, 비활성화합니다.
- 실습 에이전트는 주어진 정보와 내용을 바탕으로만 답변을 주어야 하기 때문에, 웹검색과 사전 학습 지식에 대한 답변 활용을 **비활성화** 합니다.
<img width="1078" height="1172" alt="image" src="https://github.com/user-attachments/assets/a61bfc7f-f071-4775-bc73-f140cfc90421" />


</br>
</br>

이후 **[토픽]** 으로 이동하여, 기본적으로 생성되어 있는 **[사용자 지정 토픽] 전체와 [시스템 토픽 – 대체, 일치하는 여러 토픽]을 비활성화** 합니다.
<img width="1090" height="493" alt="image" src="https://github.com/user-attachments/assets/32bce081-c1ff-4f0d-8c5c-a37f0c4ffc42" />   

</br>

**중요!**
이 작업은 Agent의 오케스트레이션이 생성형 AI로 변경되고, 이후 신규 토픽이 추가될 경우(다음 모듈) 지침과 함께 토픽에 설정된 AI 트리거 설명을 함께 검토하게 됩니다.   

</br>

기본적으로 생성된 지침의 경우 별도 설명이 포함되어 있지 않기 때문에 토픽이 중복되어 정상 답변을 할 수 없는 문제가 발생되기도 하므로, 오케스트레이션을 활성화한 상태에서 토픽을 수정, 생성하여 Agent를 운용할 예정이라면 반드시 기본 토픽은 모두 비활성화하고 신규 토픽에 대해서는 트리거에 따라 설명을 자세하게 기입합니다.

</br>

## 다음

마무리 하셨으면, [여기](https://github.com/ChangJu-Ahn/Copilot-Studio-Hands-on/blob/main/%EC%B0%B8%EC%A1%B0%EC%9E%90%EB%A3%8C%20%EA%B8%B0%EB%B0%98%20%EC%97%90%EC%9D%B4%EC%A0%84%ED%8A%B8/2.%20SharePoint%2C%20%ED%8C%8C%EC%9D%BC%20%EC%97%85%EB%A1%9C%EB%93%9C%2C%20Dataverse%20%EA%B8%B0%EB%B0%98%20%EB%8B%B5%EB%B3%80.md)를 클릭해서 다음으로 이동해요! :)
